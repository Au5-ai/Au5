class E{reload(){chrome.runtime.reload()}sendMessage(e,t=()=>{}){chrome.runtime.sendMessage(e,t)}}var w=(r=>(r.MEETING_STARTED="meetingStarted",r.MEETING_ENDED="meetingEnded",r))(w||{});async function S(r,e){const t=l=>{var n;return((n=l.textContent)==null?void 0:n.trim())===e};for(;;){const n=Array.from(document.querySelectorAll(r)).find(t);if(n instanceof HTMLElement)return n;await new Promise(requestAnimationFrame)}}class x{static async log(e){try{const t={...e,timestamp:new Date().toISOString(),extensionVersion:"1.0.0",userId:"23f45e89-8b5a-5c55-9df7-240d78a3ce15"};console.log(t)}catch(t){console.warn("[RemoteLogger] Failed to send log",t)}}static info(e,t){this.log({level:"info",message:e,context:t})}static warn(e,t){this.log({level:"warn",message:e,context:t})}static error(e,t){this.log({level:"error",message:e,context:t})}}let b=!1;const h={selector:".google-symbols",text:"call_end"},p={selector:".google-symbols",text:"closed_caption_off"};async function v(r){try{await S(h.selector,h.text),r.sendMessage({type:w.MEETING_STARTED}),b=!0}catch(e){console.error("Failed to detect meeting start:",e)}}const M={childList:!0,attributes:!0,subtree:!0,characterData:!0};let s=!0,m=!1,T;v(new E).then(()=>{var r;x.info(I()??"No meeting title found","meetingRoutines");try{const e=N(p.selector,p.text)[0];console.log("captionsButton",e),e==null||e.click();let t=document.querySelector('div[role="region"][tabindex="0"]');if(t||(t=document.querySelector(".a4cQT"),s=!1),t)s?t.setAttribute("style","opacity: 0.2;"):(r=t.children[1])==null||r.setAttribute("style","opacity: 0.2;"),T=new MutationObserver(C),T.observe(t,M);else throw new Error("Transcript element not found in DOM")}catch(e){console.error(e),m=!0}});function I(){const e=new URL(window.location.href).pathname.split("/").filter(Boolean);return e.length>0?e[e.length-1]:null}function N(r,e){const t=document.querySelectorAll(r),l=new RegExp(e);return Array.from(t).filter(n=>l.test(n.textContent||""))}let a="",o="",y="";const A="There is a bug in TranscripTonic. Please report it.";function C(r){r.forEach(()=>{var e,t,l;try{const n=s?document.querySelector('div[role="region"][tabindex="0"]'):document.querySelector(".a4cQT"),i=s?n==null?void 0:n.children:(t=(e=n==null?void 0:n.childNodes[1])==null?void 0:e.firstChild)==null?void 0:t.childNodes;if(!i)return;if(s?i.length>1:i.length>0){const d=s?i[i.length-2]:i[i.length-1],f=d.childNodes[0],g=(l=d.childNodes[1])==null?void 0:l.lastChild,u=(f==null?void 0:f.textContent)??"",c=(g==null?void 0:g.textContent)??"";u&&c&&(o===""?(a=u,y=new Date().toISOString(),o=c):a!==u?(a=u,y=new Date().toISOString(),o=c):(s&&c.length-o.length<-250&&void 0,o=c,!s&&c.length>250&&d.remove()))}else console.log("No active transcript"),a&&o&&void 0,a="",o="";console.log(o)}catch(n){console.error(n),m||console.log(A),m=!0}})}
